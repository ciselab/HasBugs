FROM haskell:8.10.7

WORKDIR /build

COPY ShellCheck.cabal ./
RUN cabal update

# Copy source and build it
COPY LICENSE shellcheck.hs ./
COPY src src
# Note: It gitignores the test folder! So we have to manually add them
COPY test test

#RUN cabal build Paths_ShellCheck && \
#  ghc -optl-static -optl-pthread -isrc -idist/build/autogen --make shellcheck -split-sections -optc-Wl,--gc-sections -optlo-Os && \
#  strip --strip-all shellcheck

#RUN cabal install --enable-tests
RUN cabal test
